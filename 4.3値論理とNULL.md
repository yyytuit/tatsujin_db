# 3 値論理と NULL

- 通常のプログラミング言語が真と偽の 2 つの真理値を持つ 2 値論理を基礎とするのに対し、SQL は第 3 の値「不明(unknown)」を追加した 3 値論理という得意な論理体系を採用している。

  3 値論理はトリッキーな動きをする。

- データベースに null が 1 つでも入ると、クエリから正しくない結果が返される可能性がある。

  しかも、一般的にどのクエリから正しくない結果が返されるのかを知る方法はない。

  null が含まれたデータベースから正しい結果が得られることは確信できない。

# 本題に入る前に

- 多くのプログラミング言語が、真理値型(BOOL 型、BOOLEAN 型)というデータ型を持っている。

  SQL にも存在する。

  普通のプログラミング言語と SQL の違いは以下

  1. true、false を持つ 2 値論理：普通のプログラミング言語

  1. 1 に加えて unknown を持つ 3 値論理 : SQL

* なぜ SQL は 3 値論理が採用されているのか？

  理由は NULL にある。

  リレーショナルデータベースは NULL を持ち込んだことにより、3 値論理も持ち込まざるをえないくなった。

# 理論編

## 2 つの NULL、3 値論理かそれとも 4 値論理か?

- NULL はもちろん 1 種類しかないが、NULL についての議論は一般的に NULL を 2 種類に分けて考える。

  2 種類の NULL は「未知(Unknown)」と「適用不能(Not Applicable, Inapplicable)」

  例えばサングランスをかけた人の目の色は分からない。その人が目の色を持つことは確かだが、サングラスを外して調べるまでは未知。

  一方、冷蔵庫の目の色も分からない。こちらはそもそも冷蔵庫に「目の色」という属性は適用不能だから。

  適用不能の NULL は「無意味」「論理的に不可能」という概念。

## なぜ「=NULL」ではなく「IS NULL」と書くのか？

- それは NULL が値でも変数でもないから。

  「=」などの比較述語を適用できるのは値だけ。なので NULL に比較述語を使うのはナンセンスであり、「=」での比較は失敗する。

  リレーショナルデータベースでは扱われる値はすべて、文字型や数値型などの何らかの型を持つ。

  仮に NULL が値なら何らかの型をもつはずだが、型はなく、定義を与えるとしたら「ここには値がない」という分の短縮系。

- NULL を値と勘違いするのは C 言語などのプログラミング言語では NULL が１つの定数として扱われるから。

  ただし、SQL とプログラミング言語の NULL は全くの別物。

## unknown、第 3 の真理値

- 真理値 unknown はリレーショナルデータベースが NULL を採用したことによって持ち込まれた「第 3 の真理値」。

- 真理値の unknown と NULL の一種である UNKNOWN(未知)は異なるもの。

  両者の違いは以下である。

  unknown = unknown --true

  UNKNOWN = UNKNOWN --unknown
